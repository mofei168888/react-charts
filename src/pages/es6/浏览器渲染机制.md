## 浏览器渲染机制
* 页面加载过程
    1. 浏览器根据DNS服务器解析得到域名的IP地址
    2. 向这个IP机器发送HTTP请求
    3. 服务器收到、处理并返回HTTP请求
    4. 浏览器得到返回内容
* 浏览器渲染过程
    + 浏览器解析三个东西
        1. 浏览器将HTML字符串解析转换DOM树结构
        2. 解析CSS产生CSS规则树，与DOM结构类似
        3. 加载JavaScript脚本文件，通过DOM API和CSSOM API来操作DOM Tree和CSS Rule Tree
    + 解析完成后，浏览器引擎会通过DOM Tree 和 CSS Rule Tree 来构造Rendering Tree
        1. Rendering Tree 渲染树并不等同与DOM树，渲染树只会包括需要显示的节点和这些节点的样式信息
        2. CSS 的Rule Tree主要是为了完成匹配并把CSS Rule附加到Rendering Tree上的每个Element（也就是Frame）
        3. 然后，计算每个Frame的位置，这又叫layout和reflow过程
* 布局与绘制
    - 当浏览器生成渲染树以后，就会根据渲染树来进行布局（也叫做回流）。这一阶段浏览器要做的事情就是要弄清楚各个节点在页面中的确切位置和大小。通常这一行为也被成为“自动重排”
    - 布局流程的输出是一个“盒模型”，它会精确地捕获每个元素在视口内的确切位置和尺寸，所以相对测量值都将转换为屏幕上的绝对像素
    - 布局完成后，浏览器会立即发出“Paint Setup”和“Paint”事件，将渲染树转换成屏幕的像素
* 知识补充
    1. js中async 和 defer 的作用是什么？有什么区别？
        - async 是异步加载，无顺序加载
        - defer 延迟加载，有顺序加载
    2. 为什么操作DOM 慢  
         DOM 是属于渲染引擎中的东西，而 JS 又是 JS 引擎，js引擎和DOM渲染引擎之间跨界操作会造成比较大的性能开销
    3. 理解回流和重绘
        - 重绘：当我们对DOM的修改导致了样式的变化，却并未影响其几何属性（比如修改了颜色或背景色）时，浏览器不需要重新计算元素的几何属性、直接为该元素绘制新的样式（跳过了上图所示的回流环节）
        - 回流：当我们对DOM的修改引发了DOM几何尺寸的变化（比如修改元素的宽、高或隐藏元素等）时，浏览器需要重新计算元素的几何属性（其他元素的几何属性和位置也会因此受到影响），然后再将计算的结果绘制出来。这个过程就是回流（也叫重排）
        - 回流必定会发生重绘，重绘不一定会引发回流
    4. 常见引起回流的属性和方法  
        任何会改变元素几何信息（元素的位置和尺寸大小）的操作，都会触发回流。 
        + 添加或者删除可见的DOM元素
        + 元素尺寸改变——边距、填充、边框、宽度和高度
        + 内容变化，比如用户在input框中输入文字
        + 浏览器窗口尺寸改变——resize事件发生时
        + 计算offsetWidth 和 offsetHeight 属性
        + 设置style属性的值
    5. 常见引起重绘属性和方法  
        color  
        border-style  
        visibility  
        background   
        text-decoration  
        background-image  
        background-position  
        background-repeat  
        outline-color  
        outline  
        outline-style 
        border-radius  
        outline-width  
        box-shadow  
        background-size  
    6. 如何减少回流、重绘
        + 使用transform 代替 top
        + 使用 visibility 替换 display: none ，因为前者只会引起重绘，后者会引发回流（改变了布局）
        + 使用 visibility 替换 display: none ，因为前者只会引起重绘，后者会引发回流（改变了布局）
        + 不要使用 table 布局，可能很小的一个小改动会造成整个 table 的重新布局
        + 动画实现的速度的选择，动画速度越快，回流次数越多，也可以选择使用 requestAnimationFrame
        + CSS 选择符从右往左匹配查找，避免节点层级过多
        + 将频繁重绘或者回流的节点设置为图层，图层能够阻止该节点的渲染行为影响别的节点。比如对于 video 标签来说，浏览器会自动将该节点变为图层。
---